import{_ as h,B as C,q as k,o as u,c as F,a as s,b as d,w as a,p as l,t as i,F as _,u as P,m as b,l as z,s as m,v as f,z as A,j as w,f as x,r as p}from"./index-N_QlHFU0.js";import{C as j}from"./CustomSelect-C3UNst7j.js";const S={name:"Fornecedores",components:{BaseTable:k,BaseButton:C,CustomSelect:j},data(){return{fornecedores:[],pageSize:25,currentPageFornecedores:1,showCreateFornecedor:!1,novoFornecedor:{razao_social:"",cnpj:"",inscricao_estadual:"",telefone:"",email:"",uf:"",status:!0},editingFornecedorIndex:null}},mounted(){this.fetchFornecedores()},computed:{fornecedorCols(){return[{key:"razao_social",label:"Razão Social"},{key:"cnpj",label:"CNPJ"},{key:"inscricao_estadual",label:"Inscrição Estadual"},{key:"uf",label:"UF"},{key:"telefone",label:"Telefone"},{key:"email",label:"Email"},{key:"status",label:"Ativo"},{key:"acoes",label:"Ações"}]},visibleFornecedores(){return(this.fornecedores||[]).filter(r=>r&&(r.razao_social||r.cnpj||r.telefone||r.email))},totalPagesFornecedores(){return Math.max(1,Math.ceil(this.visibleFornecedores.length/this.pageSize))},paginatedFornecedores(){const r=(this.currentPageFornecedores-1)*this.pageSize;return this.visibleFornecedores.slice(r,r+this.pageSize)},ufOptions(){return[{value:"",label:"UF"},...["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"].map(r=>({value:r,label:r}))]}},methods:{async fetchFornecedores(){try{const r=await x.get("/api/v1/fornecedores");this.fornecedores=Array.isArray(r.data)?r.data:r.data.items||[]}catch(r){console.error("Erro ao carregar fornecedores",r),this.fornecedores=[]}},prevFornecedores(){this.currentPageFornecedores>1&&this.currentPageFornecedores--},nextFornecedores(){this.currentPageFornecedores<this.totalPagesFornecedores&&this.currentPageFornecedores++},goToFornecedores(r){this.currentPageFornecedores=Math.min(Math.max(1,r),this.totalPagesFornecedores)},openCreateFornecedor(){this.editingFornecedorIndex=null,this.novoFornecedor={razao_social:"",cnpj:"",inscricao_estadual:"",telefone:"",email:"",uf:"",status:!0},this.showCreateFornecedor=!0},closeCreateFornecedor(){this.showCreateFornecedor=!1,this.novoFornecedor={razao_social:"",cnpj:"",inscricao_estadual:"",telefone:"",email:"",uf:"",status:!0},this.editingFornecedorIndex=null},async createFornecedor(){try{const r={razao_social:this.novoFornecedor.razao_social,cnpj:this.novoFornecedor.cnpj,inscricao_estadual:this.novoFornecedor.inscricao_estadual,telefone:this.novoFornecedor.telefone,email:this.novoFornecedor.email,uf:this.novoFornecedor.uf||null,status:!!this.novoFornecedor.status},e=await x.post("/api/v1/fornecedores",r);e.data&&e.data.id&&this.fornecedores.unshift({id:e.data.id,...r}),this.closeCreateFornecedor()}catch(r){console.error("Erro ao criar fornecedor",r)}},editFornecedor(r){const e=this.fornecedores.indexOf(r);e!==-1&&(this.editingFornecedorIndex=e,this.novoFornecedor={...r,status:!!r.status},this.showCreateFornecedor=!0)},deleteFornecedor(r){const e=this.fornecedores.indexOf(r);e!==-1&&this.fornecedores.splice(e,1)}}},V={class:"mb-6"},B={class:"flex justify-between items-center mb-2"},T={key:0,class:"panel-inner"},I={class:"flex items-center gap-2"},E={class:"mt-2 flex items-center justify-end gap-2"},M=["onClick"],O={key:1,class:"py-12 text-center"},N={class:"flex justify-center"},U={key:0,class:"fixed inset-0 z-40 flex items-center justify-center"},R={class:"bg-white rounded-2xl shadow-md z-50 w-full max-w-md p-8"},D={class:"mb-2",style:{"min-width":"88px"}},J={class:"switch-label mb-2"},q={class:"text-sm status-text"},G={class:"flex justify-end gap-3 mt-4"};function L(r,e,H,K,n,t){const c=p("BaseButton"),g=p("BaseTable"),y=p("CustomSelect");return u(),F("div",null,[e[22]||(e[22]=s("h1",{class:"text-2xl font-bold mb-4 text-gray-800"},"Fornecedores",-1)),s("div",V,[s("div",B,[e[10]||(e[10]=s("h2",{class:"text-xl font-semibold text-gray-800"},"Fornecedores",-1)),d(c,{class:"btn-primary",onClick:t.openCreateFornecedor},{default:a(()=>[...e[9]||(e[9]=[l("Adicionar Fornecedor",-1)])]),_:1},8,["onClick"])]),t.visibleFornecedores.length>0?(u(),F("div",T,[d(g,{columns:t.fornecedorCols,rows:t.paginatedFornecedores},{razao_social:a(({row:o})=>[l(i(o.razao_social),1)]),cnpj:a(({row:o})=>[l(i(o.cnpj||"-"),1)]),inscricao_estadual:a(({row:o})=>[l(i(o.inscricao_estadual||"-"),1)]),uf:a(({row:o})=>[l(i(o.uf||"-"),1)]),telefone:a(({row:o})=>[l(i(o.telefone||"-"),1)]),email:a(({row:o})=>[l(i(o.email||"-"),1)]),status:a(({row:o})=>[l(i(o.status?"ATIVO":"INATIVO"),1)]),acoes:a(({row:o})=>[s("div",I,[d(c,{variant:"ghost",onClick:v=>t.editFornecedor(o)},{default:a(()=>[...e[11]||(e[11]=[l("Editar",-1)])]),_:1},8,["onClick"]),d(c,{variant:"destructive",onClick:v=>t.deleteFornecedor(o)},{default:a(()=>[...e[12]||(e[12]=[l("Excluir",-1)])]),_:1},8,["onClick"])])]),_:1},8,["columns","rows"]),s("div",E,[d(c,{class:"btn-secondary",disabled:n.currentPageFornecedores<=1,onClick:t.prevFornecedores},{default:a(()=>[...e[13]||(e[13]=[l("Anterior",-1)])]),_:1},8,["disabled","onClick"]),(u(!0),F(_,null,P(Math.min(5,t.totalPagesFornecedores),o=>(u(),F("button",{key:o,class:b(["px-2 py-1 rounded text-sm",{"bg-gray-200":n.currentPageFornecedores===o}]),onClick:v=>t.goToFornecedores(o)},i(o),11,M))),128)),d(c,{class:"btn-secondary",disabled:n.currentPageFornecedores>=t.totalPagesFornecedores,onClick:t.nextFornecedores},{default:a(()=>[...e[14]||(e[14]=[l("Próximo",-1)])]),_:1},8,["disabled","onClick"])])])):(u(),F("div",O,[e[16]||(e[16]=s("p",{class:"text-lg font-medium mb-4 text-gray-800"},"Nenhum fornecedor cadastrado.",-1)),e[17]||(e[17]=s("p",{class:"text-sm muted mb-6"},"Adicione fornecedores para começar.",-1)),s("div",N,[d(c,{class:"btn-primary",onClick:t.openCreateFornecedor},{default:a(()=>[...e[15]||(e[15]=[l("Adicionar Fornecedor",-1)])]),_:1},8,["onClick"])])]))]),n.showCreateFornecedor?(u(),F("div",U,[s("div",{class:"fixed inset-0 bg-black/40",onClick:e[0]||(e[0]=(...o)=>t.closeCreateFornecedor&&t.closeCreateFornecedor(...o)),"aria-hidden":"true"}),s("div",R,[e[21]||(e[21]=s("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Adicionar Fornecedor",-1)),s("form",{onSubmit:e[8]||(e[8]=z((...o)=>t.createFornecedor&&t.createFornecedor(...o),["prevent"])),class:"grid grid-cols-1 gap-3"},[m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>n.novoFornecedor.razao_social=o),placeholder:"Razão Social",class:"p-3 border border-gray-300 rounded-xl",required:""},null,512),[[f,n.novoFornecedor.razao_social]]),m(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>n.novoFornecedor.cnpj=o),placeholder:"CNPJ",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[f,n.novoFornecedor.cnpj]]),m(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>n.novoFornecedor.inscricao_estadual=o),placeholder:"Inscrição Estadual",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[f,n.novoFornecedor.inscricao_estadual]]),m(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>n.novoFornecedor.telefone=o),placeholder:"Telefone",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[f,n.novoFornecedor.telefone]]),m(s("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>n.novoFornecedor.email=o),placeholder:"Email",type:"email",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[f,n.novoFornecedor.email]]),s("div",D,[d(y,{modelValue:n.novoFornecedor.uf,"onUpdate:modelValue":e[6]||(e[6]=o=>n.novoFornecedor.uf=o),options:t.ufOptions,placeholder:"UF",class:"w-full input-uf"},null,8,["modelValue","options"])]),s("div",J,[s("label",{class:b(["switch",{active:n.novoFornecedor.status}])},[m(s("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=o=>n.novoFornecedor.status=o)},null,512),[[A,n.novoFornecedor.status]]),e[18]||(e[18]=s("span",{class:"knob"},null,-1))],2),s("span",q,i(n.novoFornecedor.status?"ATIVO":"INATIVO"),1)]),s("div",G,[d(c,{type:"button",class:"btn-secondary",onClick:t.closeCreateFornecedor},{default:a(()=>[...e[19]||(e[19]=[l("Cancelar",-1)])]),_:1},8,["onClick"]),d(c,{type:"submit",class:"btn-primary"},{default:a(()=>[...e[20]||(e[20]=[l("Adicionar",-1)])]),_:1})])],32)])])):w("",!0)])}const X=h(S,[["render",L],["__scopeId","data-v-1c384141"]]);export{X as default};
