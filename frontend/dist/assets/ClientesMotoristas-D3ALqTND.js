import{_ as M,B as P,q as w,o as C,c as m,a as i,b as a,w as o,p as r,t as c,F as A,u as V,m as f,l as x,s as u,v,z as y,j as k,f as p,r as b}from"./index-N_QlHFU0.js";import{C as T}from"./CustomSelect-C3UNst7j.js";const j={name:"ClientsDrivers",components:{BaseTable:w,BaseButton:P,CustomSelect:T},data(){return{clients:[],motoristas:[],activeTab:"clients",pageSize:25,currentPageClients:1,currentPageDrivers:1,showCreateClient:!1,showCreateDriver:!1,novaCliente:{nome:"",cpf_cnpj:"",telefone:"",email:"",uf:"",status:!0},novoMotorista:{nome:"",placa:"",veiculo:"",uf:"",telefone:"",status:!0},editingClientIndex:null,editingDriverIndex:null}},mounted(){this.fetchClients(),this.fetchDrivers()},computed:{clientCols(){return[{key:"nome",label:"Nome"},{key:"cpf_cnpj",label:"CPF / CNPJ"},{key:"uf",label:"UF"},{key:"telefone",label:"Telefone"},{key:"email",label:"Email"},{key:"status",label:"Ativo"},{key:"acoes",label:"Ações"}]},driverCols(){return[{key:"nome",label:"Nome"},{key:"placa",label:"Placa"},{key:"veiculo",label:"Veículo"},{key:"uf",label:"UF"},{key:"telefone",label:"Telefone"},{key:"status",label:"Ativo"},{key:"acoes",label:"Ações"}]},visibleClients(){return(this.clients||[]).filter(t=>t&&(t.nome||t.cpf_cnpj||t.telefone||t.email))},totalPagesClients(){return Math.max(1,Math.ceil(this.visibleClients.length/this.pageSize))},paginatedClients(){const t=(this.currentPageClients-1)*this.pageSize;return this.visibleClients.slice(t,t+this.pageSize)},visibleDrivers(){return(this.motoristas||[]).filter(t=>t&&(t.nome||t.placa||t.veiculo||t.telefone))},totalPagesDrivers(){return Math.max(1,Math.ceil(this.visibleDrivers.length/this.pageSize))},paginatedDrivers(){const t=(this.currentPageDrivers-1)*this.pageSize;return this.visibleDrivers.slice(t,t+this.pageSize)},ufOptions(){return[{value:"",label:"UF"},...["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"].map(t=>({value:t,label:t}))]}},methods:{async fetchClients(){try{const t=await p.get("/api/v1/clientes");this.clients=Array.isArray(t.data)?t.data:t.data.items||[]}catch(t){console.error("Erro ao carregar clientes",t),this.clients=[]}},async fetchDrivers(){try{const t=await p.get("/api/v1/motoristas");this.motoristas=Array.isArray(t.data)?t.data:t.data.items||[]}catch(t){console.error("Erro ao carregar motoristas",t),this.motoristas=[]}},prevClients(){this.currentPageClients>1&&this.currentPageClients--},nextClients(){this.currentPageClients<this.totalPagesClients&&this.currentPageClients++},goToClients(t){this.currentPageClients=Math.min(Math.max(1,t),this.totalPagesClients)},prevDrivers(){this.currentPageDrivers>1&&this.currentPageDrivers--},nextDrivers(){this.currentPageDrivers<this.totalPagesDrivers&&this.currentPageDrivers++},goToDrivers(t){this.currentPageDrivers=Math.min(Math.max(1,t),this.totalPagesDrivers)},openCreateClient(){this.editingClientIndex=null,this.novaCliente={nome:"",cpf_cnpj:"",telefone:"",email:"",status:!0},this.showCreateClient=!0},closeCreateClient(){this.showCreateClient=!1,this.novaCliente={nome:"",cpf_cnpj:"",telefone:"",email:"",status:!0},this.editingClientIndex=null},async createClient(){try{const t={nome:this.novaCliente.nome,cpf_cnpj:this.novaCliente.cpf_cnpj,telefone:this.novaCliente.telefone,email:this.novaCliente.email,uf:this.novaCliente.uf||null,status:!!this.novaCliente.status},e=await p.post("/api/v1/clientes",t);e.data&&e.data.id&&this.clients.unshift({id:e.data.id,...t}),this.closeCreateClient()}catch(t){console.error("Erro ao criar cliente",t)}},editClient(t){const e=this.clients.indexOf(t);e!==-1&&(this.editingClientIndex=e,this.novaCliente={...t,status:!!t.status},this.showCreateClient=!0)},deleteClient(t){const e=this.clients.indexOf(t);e!==-1&&this.clients.splice(e,1)},openCreateDriver(){this.editingDriverIndex=null,this.novoMotorista={nome:"",placa:"",veiculo:"",telefone:"",status:!0},this.showCreateDriver=!0},closeCreateDriver(){this.showCreateDriver=!1,this.novoMotorista={nome:"",placa:"",veiculo:"",telefone:"",status:!0},this.editingDriverIndex=null},async createDriver(){try{const t={nome:this.novoMotorista.nome,placa:this.novoMotorista.placa,veiculo:this.novoMotorista.veiculo,uf:this.novoMotorista.uf||null,telefone:this.novoMotorista.telefone,status:!!this.novoMotorista.status},e=await p.post("/api/v1/motoristas",t);e.data&&e.data.id&&this.motoristas.unshift({id:e.data.id,...t}),this.closeCreateDriver()}catch(t){console.error("Erro ao criar motorista",t)}},editDriver(t){const e=this.motoristas.indexOf(t);e!==-1&&(this.editingDriverIndex=e,this.novoMotorista={...t,status:!!t.status},this.showCreateDriver=!0)},deleteDriver(t){const e=this.motoristas.indexOf(t);e!==-1&&this.motoristas.splice(e,1)}}},I={class:"mb-6"},S={class:"flex justify-between items-center mb-2"},U={key:0,class:"panel-inner"},O={class:"flex items-center gap-2"},B={class:"mt-2 flex items-center justify-end gap-2"},N=["onClick"],z={key:1,class:"py-12 text-center"},E={class:"flex justify-center"},_={key:0,class:"fixed inset-0 z-40 flex items-center justify-center"},F={class:"bg-white rounded-2xl shadow-md z-50 w-full max-w-md p-8"},R={class:"mb-2",style:{"min-width":"88px"}},q={class:"switch-label mb-2"},J={class:"text-sm status-text"},G={class:"flex justify-end gap-3 mt-4"},L={key:1,class:"fixed inset-0 z-40 flex items-center justify-center"},H={class:"bg-white rounded-2xl shadow-md z-50 w-full max-w-md p-8"},K={class:"mb-2",style:{"min-width":"88px"}},Q={class:"switch-label mb-2"},W={class:"text-sm status-text"},X={class:"flex justify-end gap-3 mt-4"};function Y(t,e,Z,$,l,n){const d=b("BaseButton"),D=b("BaseTable"),h=b("CustomSelect");return C(),m("div",null,[e[33]||(e[33]=i("h1",{class:"text-2xl font-bold mb-4 text-gray-800"},"Clientes",-1)),i("div",I,[i("div",S,[e[17]||(e[17]=i("h2",{class:"text-xl font-semibold text-gray-800"},"Clientes",-1)),a(d,{class:"btn-primary",onClick:n.openCreateClient},{default:o(()=>[...e[16]||(e[16]=[r("Adicionar Cliente",-1)])]),_:1},8,["onClick"])]),n.visibleClients.length>0?(C(),m("div",U,[a(D,{columns:n.clientCols,rows:n.paginatedClients},{nome:o(({row:s})=>[r(c(s.nome),1)]),cpf_cnpj:o(({row:s})=>[r(c(s.cpf_cnpj||"-"),1)]),uf:o(({row:s})=>[r(c(s.uf||"-"),1)]),telefone:o(({row:s})=>[r(c(s.telefone||"-"),1)]),email:o(({row:s})=>[r(c(s.email||"-"),1)]),status:o(({row:s})=>[r(c(s.status?"ATIVO":"INATIVO"),1)]),acoes:o(({row:s})=>[i("div",O,[a(d,{variant:"ghost",onClick:g=>n.editClient(s)},{default:o(()=>[...e[18]||(e[18]=[r("Editar",-1)])]),_:1},8,["onClick"]),a(d,{variant:"destructive",onClick:g=>n.deleteClient(s)},{default:o(()=>[...e[19]||(e[19]=[r("Excluir",-1)])]),_:1},8,["onClick"])])]),_:1},8,["columns","rows"]),i("div",B,[a(d,{class:"btn-secondary",disabled:l.currentPageClients<=1,onClick:n.prevClients},{default:o(()=>[...e[20]||(e[20]=[r("Anterior",-1)])]),_:1},8,["disabled","onClick"]),(C(!0),m(A,null,V(Math.min(5,n.totalPagesClients),s=>(C(),m("button",{key:s,class:f(["px-2 py-1 rounded text-sm",{"bg-gray-200":l.currentPageClients===s}]),onClick:g=>n.goToClients(s)},c(s),11,N))),128)),a(d,{class:"btn-secondary",disabled:l.currentPageClients>=n.totalPagesClients,onClick:n.nextClients},{default:o(()=>[...e[21]||(e[21]=[r("Próximo",-1)])]),_:1},8,["disabled","onClick"])])])):(C(),m("div",z,[e[23]||(e[23]=i("p",{class:"text-lg font-medium mb-4 text-gray-800"},"Nenhum cliente cadastrado.",-1)),e[24]||(e[24]=i("p",{class:"text-sm muted mb-6"},"Adicione clientes para começar.",-1)),i("div",E,[a(d,{class:"btn-primary",onClick:n.openCreateClient},{default:o(()=>[...e[22]||(e[22]=[r("Adicionar Cliente",-1)])]),_:1},8,["onClick"])])]))]),l.showCreateClient?(C(),m("div",_,[i("div",{class:"fixed inset-0 bg-black/40",onClick:e[0]||(e[0]=(...s)=>n.closeCreateClient&&n.closeCreateClient(...s)),"aria-hidden":"true"}),i("div",F,[e[28]||(e[28]=i("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Adicionar Cliente",-1)),i("form",{onSubmit:e[7]||(e[7]=x((...s)=>n.createClient&&n.createClient(...s),["prevent"])),class:"grid grid-cols-1 gap-3"},[u(i("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.novaCliente.nome=s),placeholder:"Nome",class:"p-3 border border-gray-300 rounded-xl",required:""},null,512),[[v,l.novaCliente.nome]]),u(i("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.novaCliente.cpf_cnpj=s),placeholder:"CPF ou CNPJ",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[v,l.novaCliente.cpf_cnpj]]),u(i("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.novaCliente.telefone=s),placeholder:"Telefone",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[v,l.novaCliente.telefone]]),u(i("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.novaCliente.email=s),placeholder:"Email",type:"email",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[v,l.novaCliente.email]]),i("div",R,[a(h,{modelValue:l.novaCliente.uf,"onUpdate:modelValue":e[5]||(e[5]=s=>l.novaCliente.uf=s),options:n.ufOptions,placeholder:"UF",class:"w-full input-uf"},null,8,["modelValue","options"])]),i("div",q,[i("label",{class:f(["switch",{active:l.novaCliente.status}])},[u(i("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>l.novaCliente.status=s)},null,512),[[y,l.novaCliente.status]]),e[25]||(e[25]=i("span",{class:"knob"},null,-1))],2),i("span",J,c(l.novaCliente.status?"ATIVO":"INATIVO"),1)]),i("div",G,[a(d,{type:"button",class:"btn-secondary",onClick:n.closeCreateClient},{default:o(()=>[...e[26]||(e[26]=[r("Cancelar",-1)])]),_:1},8,["onClick"]),a(d,{type:"submit",class:"btn-primary"},{default:o(()=>[...e[27]||(e[27]=[r("Adicionar",-1)])]),_:1})])],32)])])):k("",!0),l.showCreateDriver?(C(),m("div",L,[i("div",{class:"fixed inset-0 bg-black/40",onClick:e[8]||(e[8]=(...s)=>n.closeCreateDriver&&n.closeCreateDriver(...s)),"aria-hidden":"true"}),i("div",H,[e[32]||(e[32]=i("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Adicionar Motorista",-1)),i("form",{onSubmit:e[15]||(e[15]=x((...s)=>n.createDriver&&n.createDriver(...s),["prevent"])),class:"grid grid-cols-1 gap-3"},[u(i("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>l.novoMotorista.nome=s),placeholder:"Nome",class:"p-3 border border-gray-300 rounded-xl",required:""},null,512),[[v,l.novoMotorista.nome]]),u(i("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>l.novoMotorista.placa=s),placeholder:"Placa",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[v,l.novoMotorista.placa]]),u(i("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>l.novoMotorista.veiculo=s),placeholder:"Veículo",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[v,l.novoMotorista.veiculo]]),u(i("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>l.novoMotorista.telefone=s),placeholder:"Telefone",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[v,l.novoMotorista.telefone]]),i("div",K,[a(h,{modelValue:l.novoMotorista.uf,"onUpdate:modelValue":e[13]||(e[13]=s=>l.novoMotorista.uf=s),options:n.ufOptions,placeholder:"UF",class:"w-full input-uf"},null,8,["modelValue","options"])]),i("div",Q,[i("label",{class:f(["switch",{active:l.novoMotorista.status}])},[u(i("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=s=>l.novoMotorista.status=s)},null,512),[[y,l.novoMotorista.status]]),e[29]||(e[29]=i("span",{class:"knob"},null,-1))],2),i("span",W,c(l.novoMotorista.status?"ATIVO":"INATIVO"),1)]),i("div",X,[a(d,{type:"button",class:"btn-secondary",onClick:n.closeCreateDriver},{default:o(()=>[...e[30]||(e[30]=[r("Cancelar",-1)])]),_:1},8,["onClick"]),a(d,{type:"submit",class:"btn-primary"},{default:o(()=>[...e[31]||(e[31]=[r("Adicionar",-1)])]),_:1})])],32)])])):k("",!0)])}const se=M(j,[["render",Y],["__scopeId","data-v-43ec0e47"]]);export{se as default};
