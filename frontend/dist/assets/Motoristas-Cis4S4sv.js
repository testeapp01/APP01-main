import{_ as P,B as w,A as V,C as A,o as r,c as d,a as o,l as O,s as m,v as p,b as u,m as T,z as U,t as h,w as C,p as f,j as M,r as g,F as y,u as x,f as b}from"./index-N_QlHFU0.js";import{C as k}from"./CustomSelect-C3UNst7j.js";const B={components:{CustomSelect:k,BaseButton:w},props:["showCreateModal","closeCreateModal","create","nome","cpf","placa","veiculo","telefone","uf","TpCaminhao","status","ufOptions","caminhaoOptions"],setup(a,{emit:e}){const l=V({nome:a.nome||"",cpf:a.cpf||"",placa:a.placa||"",veiculo:a.veiculo||"",telefone:a.telefone||"",uf:a.uf||"",TpCaminhao:a.TpCaminhao||"",status:a.status??!0});A(()=>a.showCreateModal,s=>{s&&(l.nome=a.nome||"",l.cpf=a.cpf||"",l.placa=a.placa||"",l.veiculo=a.veiculo||"",l.telefone=a.telefone||"",l.uf=a.uf||"",l.TpCaminhao=a.TpCaminhao||"",l.status=a.status??!0)});function n(){e("update:nome",l.nome),e("update:cpf",l.cpf),e("update:placa",l.placa),e("update:veiculo",l.veiculo),e("update:telefone",l.telefone),e("update:uf",l.uf),e("update:TpCaminhao",l.TpCaminhao),e("update:status",l.status),a.create()}return{local:l,emitCreate:n}}},S={key:0,class:"fixed inset-0 z-40 flex items-center justify-center"},z={class:"bg-white rounded-2xl shadow-md z-50 w-full max-w-md p-8"},N={class:"mb-2",style:{"min-width":"88px"}},R={class:"mb-2"},j={class:"switch-label mb-2"},D={class:"text-sm status-text"},E={class:"flex justify-end gap-3 mt-4"};function F(a,e,l,n,s,i){const c=g("CustomSelect"),v=g("BaseButton");return l.showCreateModal?(r(),d("div",S,[o("div",{class:"fixed inset-0 bg-black/40",onClick:e[0]||(e[0]=(...t)=>l.closeCreateModal&&l.closeCreateModal(...t)),"aria-hidden":"true"}),o("div",z,[e[13]||(e[13]=o("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Adicionar Motorista",-1)),o("form",{onSubmit:e[9]||(e[9]=O((...t)=>n.emitCreate&&n.emitCreate(...t),["prevent"])),class:"grid grid-cols-1 gap-3"},[m(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>n.local.nome=t),placeholder:"Nome",class:"p-3 border border-gray-300 rounded-xl",required:""},null,512),[[p,n.local.nome]]),m(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>n.local.cpf=t),placeholder:"CPF",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[p,n.local.cpf]]),m(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>n.local.placa=t),placeholder:"Placa",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[p,n.local.placa]]),m(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>n.local.veiculo=t),placeholder:"Veículo",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[p,n.local.veiculo]]),m(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>n.local.telefone=t),placeholder:"Telefone",class:"p-3 border border-gray-300 rounded-xl"},null,512),[[p,n.local.telefone]]),o("div",N,[u(c,{modelValue:n.local.uf,"onUpdate:modelValue":e[6]||(e[6]=t=>n.local.uf=t),options:l.ufOptions,placeholder:"UF",class:"w-full input-uf"},null,8,["modelValue","options"])]),o("div",R,[u(c,{modelValue:n.local.TpCaminhao,"onUpdate:modelValue":e[7]||(e[7]=t=>n.local.TpCaminhao=t),options:l.caminhaoOptions,placeholder:"Tipo de Caminhão",class:"w-full input-uf"},null,8,["modelValue","options"])]),o("div",j,[o("label",{class:T(["switch",{active:n.local.status}])},[m(o("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>n.local.status=t)},null,512),[[U,n.local.status]]),e[10]||(e[10]=o("span",{class:"knob"},null,-1))],2),o("span",D,h(n.local.status?"ATIVO":"INATIVO"),1)]),o("div",E,[u(v,{type:"button",class:"btn-secondary",onClick:l.closeCreateModal},{default:C(()=>[...e[11]||(e[11]=[f("Cancelar",-1)])]),_:1},8,["onClick"]),u(v,{type:"submit",class:"btn-primary"},{default:C(()=>[...e[12]||(e[12]=[f("Adicionar",-1)])]),_:1})])],32)])])):M("",!0)}const _=P(B,[["render",F]]),I={components:{DriverModal:_,CustomSelect:k,BaseButton:w},data(){return{nome:"",cpf:"",placa:"",veiculo:"",uf:"",telefone:"",TpCaminhao:"",status:!0,motoristas:[],loading:!1,showCreateModal:!1,pageSize:25,currentPage:1,caminhaoOptions:[{value:"",label:"Tipo de Caminhão"}]}},async mounted(){this.load();try{const a=await b.get("/api/v1/tipos-caminhao");Array.isArray(a.data)&&(this.caminhaoOptions=[{value:"",label:"Tipo de Caminhão"},...a.data.map(e=>({value:e.id,label:e.nome}))])}catch{}},computed:{visibleMotoristas(){return(this.motoristas||[]).filter(a=>a&&(a.nome||a.placa||a.veiculo||a.telefone))},totalPages(){return Math.max(1,Math.ceil(this.visibleMotoristas.length/this.pageSize))},paginatedMotoristas(){const a=(this.currentPage-1)*this.pageSize;return this.visibleMotoristas.slice(a,a+this.pageSize)},ufOptions(){return[{value:"",label:"UF"},...["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"].map(a=>({value:a,label:a}))]}},methods:{async load(){this.loading=!0;try{const a=await b.get("/api/v1/motoristas");this.motoristas=a.data||[]}catch{this.motoristas=[]}finally{this.loading=!1}},openCreateModal(){this.showCreateModal=!0},closeCreateModal(){this.showCreateModal=!1,this.nome="",this.placa="",this.veiculo="",this.telefone="",this.uf="",this.TpCaminhao="",this.status=!0},async create(){try{await b.post("/api/v1/motoristas",{nome:this.nome,cpf:this.cpf,placa:this.placa,veiculo:this.veiculo,uf:this.uf||null,telefone:this.telefone,TpCaminhao:this.TpCaminhao||null,status:!!this.status}),this.closeCreateModal(),this.load()}catch{alert("Erro")}},prevPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},goToPage(a){this.currentPage=Math.min(Math.max(1,a),this.totalPages)}}},G={class:"flex items-center justify-between"},L={class:"flex items-center gap-2"},q={class:"mt-6"},J={key:0,class:"panel-inner"},H={class:"mt-2 space-y-2"},K={key:0},Q={key:0,class:"mt-2 flex items-center justify-end gap-2"},W=["disabled"],X=["onClick"],Y=["disabled"],Z={key:1,class:"py-8 text-center"};function $(a,e,l,n,s,i){const c=g("BaseButton"),v=g("DriverModal");return r(),d("div",null,[o("div",G,[e[12]||(e[12]=o("div",null,[o("h2",{class:"text-lg font-semibold"},"Motoristas"),o("p",{class:"mt-2"},"Gerencie motoristas e comissões")],-1)),o("div",L,[u(c,{variant:"ghost",onClick:i.load},{default:C(()=>[...e[10]||(e[10]=[f("Atualizar",-1)])]),_:1},8,["onClick"]),u(c,{variant:"primary",onClick:i.openCreateModal},{default:C(()=>[...e[11]||(e[11]=[f("Adicionar Motorista",-1)])]),_:1},8,["onClick"])])]),o("div",q,[e[15]||(e[15]=o("div",{class:"flex justify-between items-center mb-2"},[o("h3",{class:"font-medium"},"Lista")],-1)),s.loading||i.visibleMotoristas.length>0?(r(),d("div",J,[o("ul",H,[(r(!0),d(y,null,x(i.paginatedMotoristas,t=>(r(),d("li",{key:t.id,class:"p-2 bg-white rounded shadow"},[f(h(t.nome)+" ("+h(t.uf||"-")+") ",1),t.tipo_caminhao?(r(),d("span",K,"- "+h(t.tipo_caminhao),1)):M("",!0)]))),128))]),i.visibleMotoristas.length>0?(r(),d("div",Q,[o("button",{class:"px-2 py-1 border rounded",disabled:s.currentPage<=1,onClick:e[0]||(e[0]=(...t)=>i.prevPage&&i.prevPage(...t))},"Anterior",8,W),(r(!0),d(y,null,x(Math.min(5,i.totalPages),t=>(r(),d("button",{key:t,class:T(["px-2 py-1 rounded",{"bg-gray-200":s.currentPage===t}]),onClick:ee=>i.goToPage(t)},h(t),11,X))),128)),o("button",{class:"px-2 py-1 border rounded",disabled:s.currentPage>=i.totalPages,onClick:e[1]||(e[1]=(...t)=>i.nextPage&&i.nextPage(...t))},"Próximo",8,Y)])):M("",!0)])):(r(),d("div",Z,[e[14]||(e[14]=o("p",{class:"mb-4"},"Nenhum motorista cadastrado.",-1)),u(c,{variant:"primary",onClick:i.openCreateModal},{default:C(()=>[...e[13]||(e[13]=[f("Adicionar Motorista",-1)])]),_:1},8,["onClick"])]))]),u(v,{showCreateModal:s.showCreateModal,closeCreateModal:i.closeCreateModal,create:i.create,nome:s.nome,"onUpdate:nome":e[2]||(e[2]=t=>s.nome=t),cpf:s.cpf,"onUpdate:cpf":e[3]||(e[3]=t=>s.cpf=t),placa:s.placa,"onUpdate:placa":e[4]||(e[4]=t=>s.placa=t),veiculo:s.veiculo,"onUpdate:veiculo":e[5]||(e[5]=t=>s.veiculo=t),telefone:s.telefone,"onUpdate:telefone":e[6]||(e[6]=t=>s.telefone=t),uf:s.uf,"onUpdate:uf":e[7]||(e[7]=t=>s.uf=t),TpCaminhao:s.TpCaminhao,"onUpdate:TpCaminhao":e[8]||(e[8]=t=>s.TpCaminhao=t),status:s.status,"onUpdate:status":e[9]||(e[9]=t=>s.status=t),ufOptions:i.ufOptions,caminhaoOptions:s.caminhaoOptions},null,8,["showCreateModal","closeCreateModal","create","nome","cpf","placa","veiculo","telefone","uf","TpCaminhao","status","ufOptions","caminhaoOptions"])])}const oe=P(I,[["render",$]]);export{oe as default};
