import{_ as L,B as H,q as J,o as c,c as m,a as e,b as d,w as r,p as n,t as i,F as K,u as O,m as x,j as k,l as Q,s as P,v as w,d as R,r as A,f as M,g as f,y as F,D as _}from"./index-N_QlHFU0.js";const W={components:{BaseTable:J,BaseButton:H},setup(){const g=f([]),t=f(!1),h=f(""),o=25,u=f(1),p=f(0),l=f({id:null,codigo:"",descricao:"",unidade:"",status:"ativo"}),v=f(!1),a=f(!1),y=[{key:"codigo",label:"Código"},{key:"descricao",label:"Descrição"},{key:"unidade",label:"Unidade"},{key:"acoes",label:"Ações"}];async function b(){t.value=!0;try{const s=await M.get("/api/v1/produtos",{params:{q:h.value,page:u.value,per_page:o}});g.value=s.data.items||[],p.value=s.data.total||0}catch(s){g.value=[],p.value=0,console.error("Erro ao carregar produtos:",s)}finally{t.value=!1}}const B=_(()=>(g.value||[]).filter(s=>{if(!s)return!1;const E=s.codigo&&String(s.codigo).trim().length>0,N=s.descricao&&String(s.descricao).trim().length>0,I=s.unidade&&String(s.unidade).trim().length>0,G=s.status&&String(s.status).trim().length>0;return E||N||I||G})),C=_(()=>Math.max(1,Math.ceil(p.value/o))),z=_(()=>B.value);function D(s){u.value=Math.min(Math.max(1,s),C.value),b()}function T(){u.value<C.value&&(u.value++,b())}function U(){u.value>1&&(u.value--,b())}function V(){a.value=!1,l.value={id:null,codigo:"",descricao:"",unidade:"",status:"ativo"},v.value=!0}function j(s){a.value=!0,l.value={...s},v.value=!0}function S(){v.value=!1,l.value={id:null,codigo:"",descricao:"",unidade:"",status:"ativo"}}async function q(){try{a.value&&l.value.id?(await M.put(`/api/v1/produtos/${l.value.id}`,l.value),F().notify("Produto atualizado",{type:"success"})):(await M.post("/api/v1/produtos",l.value),F().notify("Produto criado",{type:"success"})),S(),b()}catch(s){console.error("Erro ao salvar produto:",s),F().notify("Falha ao salvar produto",{type:"error"})}}return R(()=>b()),{produtos:g,loading:t,pageSize:o,currentPage:u,tableCols:y,visibleProdutos:B,paginatedProdutos:z,totalPages:C,goToPage:D,nextPage:T,prevPage:U,loadProdutos:b,showCreateModal:v,openCreateModal:V,closeCreateModal:S,produtoForm:l,submitProduto:q,editMode:a,openEdit:j}}},X={class:"page-fade"},Y={class:"flex items-center justify-between mb-6"},Z={class:"flex items-center gap-3"},$={key:0,class:"panel-inner"},oo={key:1,class:"py-12 text-center"},to={class:"flex justify-center"},eo={key:2,class:"mt-4"},ao={class:"panel-inner flex items-center justify-between"},so={class:"text-sm muted"},lo={class:"flex items-center gap-2"},ro=["onClick"],no={key:3,class:"fixed inset-0 z-40 flex items-center justify-center"},io={class:"bg-white rounded-2xl shadow-md z-50 w-full max-w-3xl p-10 flex flex-col"},uo={class:"text-xl font-semibold mb-4 text-gray-800"},co={class:"flex items-center gap-3 mt-1"},mo={key:0,class:"absolute left-2 top-2 text-xs font-bold"},fo={class:"flex justify-end gap-3 mt-6"};function go(g,t,h,o,u,p){const l=A("BaseButton"),v=A("BaseTable");return c(),m("div",X,[e("div",Y,[t[8]||(t[8]=e("div",null,[e("h2",{class:"text-2xl font-semibold text-gray-800"},"Produtos"),e("p",{class:"mt-2 text-sm text-gray-500"},"Gerencie os produtos (código, descrição, unidade de compra)")],-1)),e("div",Z,[d(l,{class:"btn-secondary",onClick:o.loadProdutos},{default:r(()=>[...t[6]||(t[6]=[n("Atualizar",-1)])]),_:1},8,["onClick"]),d(l,{class:"btn-primary",onClick:o.openCreateModal},{default:r(()=>[...t[7]||(t[7]=[n("Adicionar Produto",-1)])]),_:1},8,["onClick"])])]),o.loading||o.visibleProdutos.length>0?(c(),m("div",$,[d(v,{columns:o.tableCols,rows:o.paginatedProdutos},{codigo:r(({row:a})=>[n(i(a.codigo||"-"),1)]),descricao:r(({row:a})=>[n(i(a.descricao||"-"),1)]),unidade:r(({row:a})=>[n(i(a.unidade||"-"),1)]),acoes:r(({row:a})=>[d(l,{variant:"ghost",onClick:y=>o.openEdit(a)},{default:r(()=>[...t[9]||(t[9]=[n("Atualizar",-1)])]),_:1},8,["onClick"])]),_:1},8,["columns","rows"])])):(c(),m("div",oo,[t[11]||(t[11]=e("p",{class:"text-lg font-medium mb-4 text-gray-800"},"Nenhum produto encontrado.",-1)),t[12]||(t[12]=e("p",{class:"text-sm muted mb-6"},"Adicione produtos ao estoque para começar.",-1)),e("div",to,[d(l,{class:"btn-primary",onClick:o.openCreateModal},{default:r(()=>[...t[10]||(t[10]=[n("Adicionar Produto",-1)])]),_:1},8,["onClick"])])])),o.visibleProdutos.length>0?(c(),m("div",eo,[e("div",ao,[e("div",so,"Mostrando "+i((o.currentPage-1)*o.pageSize+1)+" - "+i(Math.min(o.currentPage*o.pageSize,g.totalCount))+" de "+i(g.totalCount),1),e("div",lo,[d(l,{class:"btn-secondary",disabled:o.currentPage<=1,onClick:o.prevPage},{default:r(()=>[...t[13]||(t[13]=[n("Anterior",-1)])]),_:1},8,["disabled","onClick"]),(c(!0),m(K,null,O(Math.min(5,o.totalPages),a=>(c(),m("button",{key:a,class:x(["px-3 py-1 rounded",{"bg-gray-200":o.currentPage===a}]),onClick:y=>o.goToPage(a)},i(a),11,ro))),128)),d(l,{class:"btn-secondary",disabled:o.currentPage>=o.totalPages,onClick:o.nextPage},{default:r(()=>[...t[14]||(t[14]=[n("Próximo",-1)])]),_:1},8,["disabled","onClick"])])])])):k("",!0),o.showCreateModal?(c(),m("div",no,[e("div",{class:"fixed inset-0 bg-black/40",onClick:t[0]||(t[0]=(...a)=>o.closeCreateModal&&o.closeCreateModal(...a)),"aria-hidden":"true"}),e("div",io,[e("h3",uo,i(o.editMode?"Atualizar Produto":"Adicionar Produto"),1),e("form",{onSubmit:t[5]||(t[5]=Q((...a)=>o.submitProduto&&o.submitProduto(...a),["prevent"])),class:"space-y-5"},[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},"Descrição",-1)),P(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>o.produtoForm.descricao=a),placeholder:"Descrição",class:"p-3 border border-gray-300 rounded-xl w-full focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-150",required:""},null,512),[[w,o.produtoForm.descricao]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},"Descrição Complementar",-1)),P(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.produtoForm.descricao_complementar=a),placeholder:"Descrição Complementar",class:"p-3 border border-gray-300 rounded-xl w-full focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-150"},null,512),[[w,o.produtoForm.descricao_complementar]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},"Unidade de Compra",-1)),P(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.produtoForm.unidade=a),placeholder:"Unidade de Compra",class:"p-3 border border-gray-300 rounded-xl w-full focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-150",required:""},null,512),[[w,o.produtoForm.unidade]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},"Status",-1)),e("div",co,[e("button",{type:"button",onClick:t[4]||(t[4]=a=>o.produtoForm.status=o.produtoForm.status==="ativo"?"inativo":"ativo"),class:x(["relative w-16 h-7 rounded-full transition-colors duration-200 focus:outline-none",o.produtoForm.status==="ativo"?"bg-green-500":"bg-gray-300"])},[e("span",{class:x(["absolute left-0 top-0 w-8 h-7 bg-white rounded-full shadow transition-transform duration-200",o.produtoForm.status==="ativo"?"translate-x-8":""])},null,2),o.produtoForm.status==="inativo"?(c(),m("span",mo,"Inativo")):k("",!0)],2),e("span",{class:x(["text-xs font-semibold",o.produtoForm.status==="ativo"?"text-green-700":"text-gray-500"])},i(o.produtoForm.status==="ativo"?"Ativo":"Inativo"),3)])]),e("div",fo,[d(l,{type:"button",class:"btn-secondary",onClick:o.closeCreateModal},{default:r(()=>[...t[19]||(t[19]=[n("Cancelar",-1)])]),_:1},8,["onClick"]),d(l,{type:"submit",class:"btn-primary"},{default:r(()=>[n(i(o.editMode?"Salvar":"Adicionar"),1)]),_:1})])],32)])])):k("",!0)])}const bo=L(W,[["render",go]]);export{bo as default};
